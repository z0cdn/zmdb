import{_ as F}from"./index-1DQ9lz7_.js";import{aQ as O,a0 as U,a1 as $,aq as V,V as z,bb as B,bg as R,a7 as E,a9 as N,H as j,S as H,aa as K,ab as G,b6 as J,ae as L}from"./antd-vtmm7CAy.js";import{f as x,c as W,a2 as h,a9 as M,aa as n,k as e,u as t,H as X,r as Y,o as Z,s as ee,G as b,a3 as ae,ae as ne}from"./vue-Dl1fzmsf.js";import{j as te,F as oe,_ as le,u as re}from"./index-C-JhWVfG.js";import"./context-Dawj80bg.js";const ue={__name:"crud-table-modal",emits:["cancel","ok"],setup(f,{expose:a,emit:p}){const r=p,v=x(!1),l=x(!1),c=W(()=>v.value?"编辑":"新增"),y=x(),m=x({name:"",value:""}),C={style:{width:"100px"}},S={span:24};function d(u){l.value=!0,v.value=!!(u!=null&&u.id),m.value=O(u)??{name:"",value:""}}async function o(){var u;try{await((u=y.value)==null?void 0:u.validate()),r("ok"),l.value=!1}catch(s){console.log("Form Validate Failed:",s)}}function k(){var u;(u=y.value)==null||u.resetFields(),r("cancel")}return a({open:d}),(u,s)=>{const g=U,w=$,P=V,Q=z,q=B;return h(),M(q,{open:t(l),"onUpdate:open":s[3]||(s[3]=_=>X(l)?l.value=_:null),title:t(c),onOk:o,onCancel:k},{default:n(()=>[e(Q,{ref_key:"formRef",ref:y,model:t(m),class:"w-full","label-col":C,"wrapper-col":S},{default:n(()=>[e(w,{name:"name",label:"名",rules:[{required:!0,message:"请输入名"}]},{default:n(()=>[e(g,{value:t(m).name,"onUpdate:value":s[0]||(s[0]=_=>t(m).name=_),maxlength:50,placeholder:"请输入名"},null,8,["value"])]),_:1}),e(w,{name:"value",label:"值",rules:[{required:!0,message:"请输入值"}]},{default:n(()=>[e(g,{value:t(m).value,"onUpdate:value":s[1]||(s[1]=_=>t(m).value=_),maxlength:50,placeholder:"请输入值"},null,8,["value"])]),_:1}),e(w,{name:"remark",label:"备注"},{default:n(()=>[e(P,{value:t(m).remark,"onUpdate:value":s[2]||(s[2]=_=>t(m).remark=_),"show-count":"",maxlength:200,placeholder:"请输入备注"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title"])}}};async function se(f){return te("/list/crud-table",f,{customDev:!0})}async function ie(f){return oe(`/list/${f}`,null,{customDev:!0})}function de(f){const a=Y(R({queryApi:()=>Promise.resolve(),loading:!1,queryParams:{},dataSource:[],rowSelections:{selectedRowKeys:[],selectedRows:[],onChange(l,c){a.rowSelections.selectedRowKeys=l,a.rowSelections.selectedRows=c}},queryOnMounted:!0,pagination:R({pageSize:10,pageSizeOptions:["10","20","30","40"],current:1,total:0,order:"desc",column:"createTime",showSizeChanger:!0,showQuickJumper:!0,showTotal:l=>`总数据位：${l}`,onChange(l,c){a.pagination.pageSize=c,a.pagination.current=l,p()}},f.pagination),expand:!1,expandChange(){a.expand=!a.expand},beforeQuery(){},afterQuery(l){return l}},f));async function p(){if(!a.loading){a.loading=!0;try{await a.beforeQuery();const{data:l}=await a.queryApi({current:a.pagination.current,pageSize:a.pagination.pageSize,column:a.pagination.column,order:a.pagination.order,...a.queryParams});if(l){const c=await a.afterQuery(l);a.dataSource=c.records??[],a.pagination.total=c.total??0}}catch(l){throw new Error(`Query Failed: ${l}`)}finally{a.loading=!1}}}function r(){a.pagination.current=1,a.queryParams={},p()}function v(){a.pagination.current=1,p()}return Z(()=>{a.queryOnMounted&&p()}),{query:p,resetQuery:r,initQuery:v,state:a}}const ce={key:0,flex:"","gap-2":""},me={__name:"crud-table",setup(f){const a=re(),p=ee([{title:"名",dataIndex:"name"},{title:"值",dataIndex:"value"},{title:"描述",dataIndex:"remark"},{title:"操作",dataIndex:"action"}]),{state:r,initQuery:v,resetQuery:l,query:c}=de({queryApi:se,queryParams:{name:void 0,value:void 0,remark:void 0},afterQuery:d=>(console.log(d),d)}),y=x();async function m(d){if(!d.id)return a.error("id 不能为空");try{(await ie(d.id)).code===200&&await c(),a.success("删除成功")}catch(o){console.log(o)}finally{close()}}function C(){var d;(d=y.value)==null||d.open()}function S(d){var o;(o=y.value)==null||o.open(d)}return(d,o)=>{const k=U,u=$,s=N,g=j,w=H,P=K,Q=z,q=G,_=J,T=L,A=F;return h(),M(A,null,{default:n(()=>[e(q,{"mb-4":""},{default:n(()=>[e(Q,{class:"system-crud-wrapper","label-col":{span:7},model:t(r).queryParams},{default:n(()=>[e(P,{gutter:[15,0]},{default:n(()=>[e(s,{span:6},{default:n(()=>[e(u,{name:"name",label:"名"},{default:n(()=>[e(k,{value:t(r).queryParams.name,"onUpdate:value":o[0]||(o[0]=i=>t(r).queryParams.name=i),placeholder:"请输入名"},null,8,["value"])]),_:1})]),_:1}),e(s,{span:6},{default:n(()=>[e(u,{name:"value",label:"值"},{default:n(()=>[e(k,{value:t(r).queryParams.value,"onUpdate:value":o[1]||(o[1]=i=>t(r).queryParams.value=i),placeholder:"请输入值"},null,8,["value"])]),_:1})]),_:1}),e(s,{span:6},{default:n(()=>[e(u,{name:"remark",label:"备注"},{default:n(()=>[e(k,{value:t(r).queryParams.remark,"onUpdate:value":o[2]||(o[2]=i=>t(r).queryParams.remark=i),placeholder:"请输入备注"},null,8,["value"])]),_:1})]),_:1}),e(s,{span:6},{default:n(()=>[e(w,{flex:"","justify-end":"","w-full":""},{default:n(()=>[e(g,{loading:t(r).loading,type:"primary",onClick:t(v)},{default:n(()=>o[3]||(o[3]=[b(" 查询 ")])),_:1},8,["loading","onClick"]),e(g,{loading:t(r).loading,onClick:t(l)},{default:n(()=>o[4]||(o[4]=[b(" 重置 ")])),_:1},8,["loading","onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(q,{title:"增删改查表格"},{extra:n(()=>[e(w,{size:"middle"},{default:n(()=>[e(g,{type:"primary",onClick:C},{icon:n(()=>[e(t(E))]),default:n(()=>[o[5]||(o[5]=b(" 新增 "))]),_:1})]),_:1})]),default:n(()=>[e(T,{"row-key":"id","row-selection":t(r).rowSelections,loading:t(r).loading,columns:t(p),"data-source":t(r).dataSource,pagination:t(r).pagination},{bodyCell:n(i=>{var I;return[((I=i==null?void 0:i.column)==null?void 0:I.dataIndex)==="action"?(h(),ae("div",ce,[e(g,{type:"link",onClick:D=>S(i==null?void 0:i.record)},{default:n(()=>o[6]||(o[6]=[b(" 编辑 ")])),_:2},1032,["onClick"]),e(_,{title:"确定删除该条数据？","ok-text":"确定","cancel-text":"取消",onConfirm:D=>m(i==null?void 0:i.record)},{default:n(()=>[e(g,{type:"link"},{default:n(()=>o[7]||(o[7]=[b(" 删除 ")])),_:1})]),_:2},1032,["onConfirm"])])):ne("",!0)]}),_:1},8,["row-selection","loading","columns","data-source","pagination"])]),_:1}),e(ue,{ref_key:"crudTableModal",ref:y},null,512)]),_:1})}}},ve=le(me,[["__scopeId","data-v-00d2ba9b"]]);export{ve as default};
